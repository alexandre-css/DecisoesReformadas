<!DOCTYPE html>
<html lang="pt-BR" data-theme="dark">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Decisões Reformadas - Gabinete Des. Alexandre Morais da Rosa</title>
        <meta name="description" content="Visualizador de Decisões Reformadas do TJSC">

        <!-- Favicon -->
        <link rel="icon" type="image/svg+xml" href="assets/icons/favicon.svg">

        <!-- Google Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
            rel="stylesheet">

        <!-- Material Symbols -->
        <link rel="stylesheet"
            href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />

        <!-- CSS -->
        <link rel="stylesheet" href="style.css">

        <!-- XLSX Library -->
        <script src="https://cdn.jsdelivr.net/npm/xlsx-js-style@1.2.0/dist/xlsx.bundle.js"></script>

        <!-- jsPDF para exportação -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    </head>

    <body>
        <!-- Theme Toggle -->
        <div class="theme-toggle" id="theme-toggle" onclick="toggleTheme()" title="Alternar Tema">
            <span class="material-symbols-outlined">palette</span>
        </div>

        <!-- Loading Overlay -->
        <div class="loading-overlay" id="loading-overlay">
            <div class="loading-content">
                <div class="loading-spinner"></div>
                <p class="loading-text">Carregando dados...</p>
            </div>
        </div>

        <div class="app-container">
            <!-- Sidebar -->
            <aside class="sidebar" id="sidebar">
                <div class="sidebar-content">
                    <div class="sidebar-logo">
                        <div class="logo-icon">
                            <span class="material-symbols-outlined">gavel</span>
                        </div>
                        <span class="logo-text">Reformadas</span>
                    </div>

                    <div class="nav-items">
                        <div class="nav-item active" onclick="showPage('dashboard')" data-page="dashboard">
                            <span class="material-symbols-outlined">dashboard</span>
                            <span>Dashboard</span>
                        </div>
                        <div class="nav-item" onclick="showPage('tabelas')" data-page="tabelas">
                            <span class="material-symbols-outlined">table_chart</span>
                            <span>Tabelas</span>
                        </div>
                        <div class="nav-item" onclick="showPage('pesquisa')" data-page="pesquisa">
                            <span class="material-symbols-outlined">search</span>
                            <span>Pesquisa</span>
                        </div>
                        <div class="nav-item" onclick="showPage('configuracoes')" data-page="configuracoes">
                            <span class="material-symbols-outlined">settings</span>
                            <span>Configurações</span>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Main Content -->
            <main class="main-content">
                <!-- Dashboard Page -->
                <div id="dashboard-page" class="page-content">
                    <div class="page-header">
                        <div class="page-title-container">
                            <h1 class="page-title">
                                <span class="material-symbols-outlined title-icon">analytics</span>
                                Dashboard de Decisões Reformadas
                            </h1>
                            <p class="page-subtitle">Visualização consolidada dos dados do TJSC</p>
                        </div>
                        <div class="header-actions">
                            <button class="btn-action primary" onclick="carregarArquivo()">
                                <span class="material-symbols-outlined">refresh</span>
                                Atualizar Dados
                            </button>
                        </div>
                    </div>

                    <!-- KPIs Row -->
                    <div class="kpis-container">
                        <div class="kpi-card" data-aos="fade-up">
                            <div class="kpi-icon-wrapper gradient-primary">
                                <span class="material-symbols-outlined">folder_open</span>
                            </div>
                            <div class="kpi-info">
                                <span class="kpi-label">Total de Registros</span>
                                <span class="kpi-value" id="kpi-total">--</span>
                            </div>
                            <div class="kpi-trend positive">
                                <span class="material-symbols-outlined">trending_up</span>
                            </div>
                        </div>

                        <div class="kpi-card" data-aos="fade-up" data-aos-delay="100">
                            <div class="kpi-icon-wrapper gradient-success">
                                <span class="material-symbols-outlined">description</span>
                            </div>
                            <div class="kpi-info">
                                <span class="kpi-label">Planilhas Carregadas</span>
                                <span class="kpi-value" id="kpi-planilhas">--</span>
                            </div>
                            <div class="kpi-trend neutral">
                                <span class="material-symbols-outlined">remove</span>
                            </div>
                        </div>

                        <div class="kpi-card" data-aos="fade-up" data-aos-delay="200">
                            <div class="kpi-icon-wrapper gradient-info">
                                <span class="material-symbols-outlined">calendar_today</span>
                            </div>
                            <div class="kpi-info">
                                <span class="kpi-label">Última Atualização</span>
                                <span class="kpi-value small" id="kpi-atualizacao">--</span>
                            </div>
                            <div class="kpi-trend">
                                <span class="material-symbols-outlined">schedule</span>
                            </div>
                        </div>

                        <div class="kpi-card" data-aos="fade-up" data-aos-delay="300">
                            <div class="kpi-icon-wrapper gradient-warning">
                                <span class="material-symbols-outlined">view_column</span>
                            </div>
                            <div class="kpi-info">
                                <span class="kpi-label">Total de Colunas</span>
                                <span class="kpi-value" id="kpi-colunas">--</span>
                            </div>
                            <div class="kpi-trend neutral">
                                <span class="material-symbols-outlined">grid_view</span>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Overview -->
                    <div class="dashboard-grid">
                        <div class="card overview-card">
                            <div class="card-header">
                                <h3>
                                    <span class="material-symbols-outlined">list_alt</span>
                                    Visão Geral das Planilhas
                                </h3>
                            </div>
                            <div class="card-body">
                                <div class="sheets-list" id="sheets-overview">
                                    <div class="empty-state">
                                        <span class="material-symbols-outlined">upload_file</span>
                                        <p>Nenhum dado carregado</p>
                                        <small>Clique em "Atualizar Dados" para carregar o arquivo Excel</small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card stats-card">
                            <div class="card-header">
                                <h3>
                                    <span class="material-symbols-outlined">bar_chart</span>
                                    Estatísticas por Planilha
                                </h3>
                            </div>
                            <div class="card-body">
                                <div class="stats-chart" id="stats-chart">
                                    <div class="empty-state">
                                        <span class="material-symbols-outlined">insights</span>
                                        <p>Estatísticas indisponíveis</p>
                                        <small>Carregue os dados para visualizar</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="card activity-card">
                        <div class="card-header">
                            <h3>
                                <span class="material-symbols-outlined">history</span>
                                Acesso Rápido às Planilhas
                            </h3>
                        </div>
                        <div class="card-body">
                            <div class="quick-access-grid" id="quick-access">
                                <div class="empty-state">
                                    <span class="material-symbols-outlined">touch_app</span>
                                    <p>Acesso rápido</p>
                                    <small>As planilhas carregadas aparecerão aqui para acesso direto</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabelas Page -->
                <div id="tabelas-page" class="page-content hidden">
                    <div class="page-header">
                        <div class="page-title-container">
                            <h1 class="page-title">
                                <span class="material-symbols-outlined title-icon">table_chart</span>
                                Visualização de Tabelas
                            </h1>
                            <p class="page-subtitle">Navegue entre as planilhas do arquivo</p>
                        </div>
                        <div class="header-actions">
                            <button class="btn-action secondary" onclick="exportarPlanilhaAtual('excel')">
                                <span class="material-symbols-outlined">download</span>
                                Exportar Excel
                            </button>
                            <button class="btn-action secondary" onclick="exportarPlanilhaAtual('pdf')">
                                <span class="material-symbols-outlined">picture_as_pdf</span>
                                Exportar PDF
                            </button>
                        </div>
                    </div>

                    <!-- Sheet Tabs -->
                    <div class="sheet-tabs-container">
                        <div class="sheet-tabs" id="sheet-tabs">
                            <div class="empty-tab">Nenhuma planilha carregada</div>
                        </div>
                    </div>

                    <!-- Table Filter -->
                    <div class="table-filter-bar">
                        <div class="filter-search">
                            <span class="material-symbols-outlined">filter_list</span>
                            <input type="text" id="table-filter" placeholder="Filtrar dados da tabela..."
                                oninput="filtrarTabelaAtual()">
                            <button class="btn-clear" onclick="limparFiltroTabela()" title="Limpar filtro">
                                <span class="material-symbols-outlined">close</span>
                            </button>
                        </div>
                        <div class="filter-actions">
                            <button class="btn-columns" onclick="abrirSeletorColunas()"
                                title="Configurar colunas visíveis">
                                <span class="material-symbols-outlined">view_column</span>
                                <span>Colunas</span>
                            </button>
                        </div>
                        <div class="filter-info">
                            <span id="filter-count">0 registros</span>
                        </div>
                    </div>

                    <!-- Table Container -->
                    <div class="table-wrapper">
                        <div class="table-container" id="table-container">
                            <div class="empty-state large">
                                <span class="material-symbols-outlined">table_rows</span>
                                <p>Nenhuma tabela selecionada</p>
                                <small>Selecione uma planilha nas abas acima</small>
                            </div>
                        </div>
                    </div>

                    <!-- Pagination -->
                    <div class="pagination-container" id="pagination-container">
                        <div class="pagination-info">
                            <span id="pagination-info">Mostrando 0 de 0 registros</span>
                        </div>
                        <div class="pagination-controls">
                            <button class="btn-pagination" onclick="paginaAnterior()" id="btn-prev" disabled>
                                <span class="material-symbols-outlined">chevron_left</span>
                            </button>
                            <div class="pagination-pages" id="pagination-pages"></div>
                            <button class="btn-pagination" onclick="proximaPagina()" id="btn-next" disabled>
                                <span class="material-symbols-outlined">chevron_right</span>
                            </button>
                        </div>
                        <div class="pagination-size">
                            <label for="page-size">Por página:</label>
                            <select id="page-size" title="Itens por página" onchange="alterarTamanhoPagina()">
                                <option value="25">25</option>
                                <option value="50" selected>50</option>
                                <option value="100">100</option>
                                <option value="all">Todos</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Pesquisa Page -->
                <div id="pesquisa-page" class="page-content hidden">
                    <div class="page-header">
                        <div class="page-title-container">
                            <h1 class="page-title">
                                <span class="material-symbols-outlined title-icon">search</span>
                                Pesquisa Avançada
                            </h1>
                            <p class="page-subtitle">Busque em todas as planilhas simultaneamente</p>
                        </div>
                    </div>

                    <!-- Search Box -->
                    <div class="search-container">
                        <div class="search-box">
                            <div class="search-input-wrapper">
                                <span class="material-symbols-outlined search-icon">search</span>
                                <input type="text" id="global-search" placeholder="Digite sua pesquisa..."
                                    onkeyup="handleSearchKeyup(event)">
                                <button class="btn-search" onclick="realizarPesquisa()">
                                    <span class="material-symbols-outlined">arrow_forward</span>
                                </button>
                            </div>
                            <div class="search-options">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="search-case-sensitive">
                                    <span class="checkmark"></span>
                                    Diferenciar maiúsculas/minúsculas
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="search-exact-match">
                                    <span class="checkmark"></span>
                                    Correspondência exata
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="search-all-sheets" checked>
                                    <span class="checkmark"></span>
                                    Buscar em todas as planilhas
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Search Results -->
                    <div class="search-results-container">
                        <div class="search-results-header" id="search-results-header">
                            <h3>
                                <span class="material-symbols-outlined">format_list_bulleted</span>
                                Resultados da Pesquisa
                            </h3>
                            <span class="results-count" id="results-count">0 resultados encontrados</span>
                        </div>
                        <div class="search-results" id="search-results">
                            <div class="empty-state">
                                <span class="material-symbols-outlined">manage_search</span>
                                <p>Realize uma pesquisa</p>
                                <small>Digite um termo acima e pressione Enter ou clique no botão de busca</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Configurações Page -->
                <div id="configuracoes-page" class="page-content hidden">
                    <div class="page-header">
                        <div class="page-title-container">
                            <h1 class="page-title">
                                <span class="material-symbols-outlined title-icon">settings</span>
                                Configurações
                            </h1>
                            <p class="page-subtitle">Personalize a aplicação</p>
                        </div>
                    </div>

                    <div class="config-container">
                        <!-- Aparência -->
                        <div class="config-section">
                            <div class="config-section-header">
                                <span class="material-symbols-outlined">palette</span>
                                <h3>Aparência</h3>
                            </div>
                            <div class="config-items">
                                <div class="config-item">
                                    <div class="config-item-info">
                                        <label>Tema da Interface</label>
                                        <small>Escolha entre tema claro, escuro ou automático</small>
                                    </div>
                                    <select id="config-theme" class="config-select" title="Tema da interface"
                                        onchange="salvarConfiguracoes()">
                                        <option value="dark">Escuro</option>
                                        <option value="light">Claro</option>
                                        <option value="auto">Automático (sistema)</option>
                                    </select>
                                </div>
                                <div class="config-item">
                                    <div class="config-item-info">
                                        <label>Cor de Destaque</label>
                                        <small>Cor principal da interface</small>
                                    </div>
                                    <select id="config-accent" class="config-select" title="Cor de destaque"
                                        onchange="salvarConfiguracoes()">
                                        <option value="blue">Azul (padrão)</option>
                                        <option value="purple">Roxo</option>
                                        <option value="green">Verde</option>
                                        <option value="orange">Laranja</option>
                                        <option value="red">Vermelho</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Dados -->
                        <div class="config-section">
                            <div class="config-section-header">
                                <span class="material-symbols-outlined">database</span>
                                <h3>Dados</h3>
                            </div>
                            <div class="config-items">
                                <div class="config-item">
                                    <div class="config-item-info">
                                        <label>Caminho do Arquivo</label>
                                        <small>Localização do arquivo Excel</small>
                                    </div>
                                    <input type="text" id="config-filepath" class="config-input"
                                        title="Caminho do arquivo Excel" placeholder="Caminho do arquivo Excel"
                                        value="C:\Apps\DecisoesReformadas\Reformadas TJSC - Resultado Agrupado.xlsx"
                                        readonly>
                                </div>
                                <div class="config-item">
                                    <div class="config-item-info">
                                        <label>Registros por Página</label>
                                        <small>Quantidade padrão de linhas nas tabelas</small>
                                    </div>
                                    <select id="config-pagesize" class="config-select" title="Registros por página"
                                        onchange="salvarConfiguracoes()">
                                        <option value="25">25 registros</option>
                                        <option value="50" selected>50 registros</option>
                                        <option value="100">100 registros</option>
                                    </select>
                                </div>
                                <div class="config-item">
                                    <div class="config-item-info">
                                        <label>Carregar automaticamente</label>
                                        <small>Carregar dados ao iniciar a aplicação</small>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" id="config-autoload" title="Carregar automaticamente"
                                            checked onchange="salvarConfiguracoes()">
                                        <span class="slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Sobre -->
                        <div class="config-section">
                            <div class="config-section-header">
                                <span class="material-symbols-outlined">info</span>
                                <h3>Sobre</h3>
                            </div>
                            <div class="about-content">
                                <div class="about-logo">
                                    <span class="material-symbols-outlined">gavel</span>
                                </div>
                                <h4>Decisões Reformadas</h4>
                                <p>Versão 1.0.0</p>
                                <p class="about-description">
                                    Sistema de visualização e pesquisa de decisões reformadas do TJSC,
                                    desenvolvido para o Gabinete do Desembargador Alexandre Morais da Rosa.
                                </p>
                                <div class="about-credits">
                                    <small>Desenvolvido com ❤️ para o TJSC</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Footer -->
                <footer class="main-footer">
                    <span>Gabinete Des. Alexandre Morais da Rosa</span>
                </footer>
            </main>
        </div>

        <!-- Toast Container -->
        <div class="toast-container" id="toast-container"></div>

        <!-- Column Selector Modal -->
        <div class="modal-overlay" id="columns-modal">
            <div class="modal-content modal-columns">
                <div class="modal-header">
                    <h3>
                        <span class="material-symbols-outlined">view_column</span>
                        Configurar Colunas
                    </h3>
                    <button class="modal-close" onclick="fecharModalColunas()">
                        <span class="material-symbols-outlined">close</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="columns-actions">
                        <button class="btn-action secondary small" onclick="selecionarTodasColunas()">
                            <span class="material-symbols-outlined">select_all</span>
                            Selecionar Todas
                        </button>
                        <button class="btn-action secondary small" onclick="deselecionarTodasColunas()">
                            <span class="material-symbols-outlined">deselect</span>
                            Desmarcar Todas
                        </button>
                    </div>
                    <div class="columns-list" id="columns-list">
                        <!-- Checkboxes will be inserted here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-action secondary" onclick="fecharModalColunas()">
                        Cancelar
                    </button>
                    <button class="btn-action primary" onclick="aplicarSelecaoColunas()">
                        <span class="material-symbols-outlined">check</span>
                        Aplicar
                    </button>
                </div>
            </div>
        </div>

        <!-- Cell Detail Modal -->
        <div class="modal-overlay" id="cell-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modal-title">Detalhes da Célula</h3>
                    <button class="modal-close" onclick="fecharModal()">
                        <span class="material-symbols-outlined">close</span>
                    </button>
                </div>
                <div class="modal-body" id="modal-body">
                    <!-- Content will be inserted here -->
                </div>
                <div class="modal-footer">
                    <button class="btn-action secondary" onclick="copiarConteudoModal()">
                        <span class="material-symbols-outlined">content_copy</span>
                        Copiar
                    </button>
                    <button class="btn-action primary" onclick="fecharModal()">
                        Fechar
                    </button>
                </div>
            </div>
        </div>

        <!-- Scripts -->
        <script src="script.js"></script>
    </body>

</html>